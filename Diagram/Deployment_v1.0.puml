@startuml

title Видеохостинг - Диаграмма развертывания

' ==Клиентская зона==

node "Пользовательское устройство" {
    component "Web Browser (Web UI)" as UI
    component "Видео плеер" as VideoPlayer
}

' ==Публичная зона==

node "Интернет" as Internet
node "CDN" as CDN {
    component "Видео контент"
}

' ==DMZ==

node "API Zone" {
    node "API Gateway Server" {
        component "API Gateway" as API
    }
}

' ==Backend зона==

node "Backend Cluster" {
    node "Auth Server" {
        component "Auth Service" as AuthService
    }
    node "User Server" {
        component "User Service" as UserService
    }
    node "Video Server" {
        component "Video Management Service" as VideoManagementService
        component "Search Service" as SearchService
        component "Streaming Service" as StreamingService      
    }
    node "Interaction Server" {
        component "Like Service" as LikeService
        component "Comment Service" as CommentService
        component "Statistics Service" as StatisticsService
    }
    node "Upload Server" {
        component "Upload Service" as UploadService
    }
    node "Transcoding Server" {
        component "Transcoding Service" as TranscodingService
    }
    node "Message Broker" {
        component "Message Queue" as MQ
    }
}

' ==Data зона==

node "Data Zone" {
    database "User DB" as UserDB
    database "Video Metadata DB" as MetadataDB
    storage "Object Storage" as ObjectStorage
}

' ==Связи==

UI --> Internet
UI --> CDN
Internet --> API
VideoPlayer --> StreamingService

' API interactions

API --> AuthService
API --> UserService
API --> VideoManagementService
API --> SearchService
API --> StreamingService
API --> LikeService
API --> CommentService
API --> StatisticsService
API --> UploadService

' Service interactions

AuthService --> UserDB
UserService --> UserDB
VideoManagementService --> MetadataDB
VideoManagementService --> ObjectStorage
VideoManagementService --> MQ
SearchService --> MetadataDB
LikeService --> MetadataDB
CommentService --> MetadataDB
StatisticsService --> MetadataDB

' Video processing

UploadService --> ObjectStorage
TranscodingService --> ObjectStorage
TranscodingService --> CDN
MQ --> TranscodingService

' Streaming

StreamingService --> CDN
StreamingService --> MetadataDB

@enduml